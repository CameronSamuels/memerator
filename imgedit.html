<style>
div {
  overflow: hidden;
  position: relative;
  background: red;
  border-radius: .5em;
  float: left;
  padding: .5em;
}
div input {
  cursor: inherit;
    display: block;
    font-size: 999px;
    filter: alpha(opacity=0);
    min-height: 100%;
    min-width: 100%;
    opacity: 0;
    position: absolute;
    right: 0;
    text-align: right;
    top: 0;
}
img {
  display: block
}
</style>

<div>Upload file<input type="file" /></div><br />
<main><canvas id="canvas" width=500></canvas></main>

<script>
	document.querySelector('input').addEventListener("change", function(event) {
    /*var files = fileToRead.files;
    var len = files.length;
    // we should read just one file
    if (len) {
        console.log("Filename: " + files[0].name);
        console.log("Type: " + files[0].type);
        console.log("Size: " + files[0].size + " bytes");
    }*/
		var size = prompt("Width-Height");
		var canvas = document.getElementById("canvas");
		canvas.width = size.split('-')[0];
		canvas.height = size.split('-')[1];
		var min = Math.min(canvas.width,canvas.height);
		var max = Math.max(canvas.width,canvas.height);
		document.querySelector('main').style.zoom = 1-((min.toString().charAt(0)*min.toString().length/100)+(max.toString().charAt(0)*max.toString().length/100));
//		document.querySelector('main').style.zoom = 1-((min.toString().charAt(0)*max.toString().length)+(max.toString().charAt(0)*max.toString().length));
		var url = this.value;
    var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
    if (document.querySelector('input').files && document.querySelector('input').files[0]&& (ext == "gif" || ext == "png" || ext == "jpeg" || ext == "jpg")) 
     {
        var reader = new FileReader();

        reader.onload = function (e) {
//           document.querySelector('img').setAttribute('src', e.target.result);
			var canvas = document.getElementById("canvas");
			var ctx = canvas.getContext("2d");

			img = new Image();
			img.onload = function () {

				canvas.height = canvas.width * (img.height / img.width);

				/// step 1
				var oc = document.createElement('canvas'),
					octx = oc.getContext('2d');

				oc.width = img.width * 0.5;
				oc.height = img.height * 0.5;
				octx.drawImage(img, 0, 0, oc.width, oc.height);

				/// step 2
				octx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5);

				ctx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5,
				0, 0, canvas.width, canvas.height);
			}
			img.src = e.target.result;
        }
       reader.readAsDataURL(document.querySelector('input').files[0]);
    }
    else
    {
      //$('#img').attr('src', '/assets/no_preview.png');
    }
}, false);
</script>
